const TOM_TOM_API_KEY="sAySjo9SKcvsUOpYgP6XTSmMqmpnGHEY",mapElement=document.querySelector("map");function watchPosition(){navigator.geolocation.watchPosition(showResults,showError)}function showError(o){switch(o.code){case o.PERMISSION_DENIED:window.location=window.location+"/permission_denied";break;case o.POSITION_UNAVAILABLE:window.location=window.location+"/position_unavailable";break;case o.TIMEOUT:window.location=window.location+"/timeout";break;case o.UNKNOWN_ERROR:window.location=window.location+"/unknown_error"}}function showResults(o){showPosition(o)}function showPosition(o){o=[o.coords.longitude,o.coords.latitude];const t=document.createElement("div"),e=(mapElement.appendChild(t),t.classList.add("user"),tt.map({key:TOM_TOM_API_KEY,container:mapElement,stylesVisibility:{trafficIncidents:!0,trafficFlow:!0},center:o,zoom:16})),n=new tt.Marker({element:t}).setLngLat(o).addTo(e);showPosition=function(o){o=[o.coords.longitude,o.coords.latitude];n.setLngLat(o);fetch("http://overpass-api.de/api/interpreter?data=").then(o=>o.json()).then(o=>{document.querySelector("node").forEach(o=>o.remove()),o.elements.forEach(o=>{const t=document.createElement("div");mapElement.appendChild(t),t.classList.add("node"),new tt.Marker({element:t}).setLngLat([o.lon,o.lat]).addTo(e)})})}}watchPosition();